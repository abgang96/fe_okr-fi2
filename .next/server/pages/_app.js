/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/_app";
exports.ids = ["pages/_app"];
exports.modules = {

/***/ "./lib/api.js":
/*!********************!*\
  !*** ./lib/api.js ***!
  \********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   api: () => (/* binding */ api),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__]);\naxios__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nconst API_BASE_URL = \"http://127.0.0.1:8000\" || 0;\n// Create axios instance with default config\nconst apiClient = axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create({\n    baseURL: API_BASE_URL,\n    headers: {\n        \"Content-Type\": \"application/json\"\n    },\n    timeout: 15000\n});\n// Function to get the current token\nconst getToken = ()=>{\n    if (false) {}\n    return null;\n};\n// Add request interceptor for auth header\napiClient.interceptors.request.use((config)=>{\n    const token = getToken();\n    if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n}, (error)=>{\n    return Promise.reject(error);\n});\n// Add response interceptor for error handling\napiClient.interceptors.response.use((response)=>response, async (error)=>{\n    const originalRequest = error.config;\n    // If the error is 401 and we haven't retried yet\n    if (error.response?.status === 401 && !originalRequest._retry) {\n        originalRequest._retry = true;\n        try {\n            // Try to refresh the token\n            const refreshToken = localStorage.getItem(\"refreshToken\");\n            if (refreshToken) {\n                const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post(`${API_BASE_URL}/api/auth/refresh/`, {\n                    refresh: refreshToken\n                });\n                if (response.data.access) {\n                    // Store the new token\n                    localStorage.setItem(\"accessToken\", response.data.access);\n                    // Update Authorization header\n                    originalRequest.headers.Authorization = `Bearer ${response.data.access}`;\n                    // Retry the original request\n                    return apiClient(originalRequest);\n                }\n            }\n        } catch (refreshError) {\n            console.error(\"Token refresh failed:\", refreshError);\n        }\n    }\n    return Promise.reject(error);\n});\n// Helper function for checking backend connection\nconst checkConnection = async ()=>{\n    try {\n        await apiClient.get(\"/api/auth/me/\");\n        return true;\n    } catch (error) {\n        console.error(\"Backend connection failed:\", error);\n        return false;\n    }\n};\n// Export the configured client and utilities\nconst api = {\n    get: (url)=>apiClient.get(url),\n    post: (url, data)=>apiClient.post(url, data),\n    put: (url, data)=>apiClient.put(url, data),\n    delete: (url)=>apiClient.delete(url),\n    checkConnection,\n    // User methods\n    getUsers: async ()=>{\n        const response = await apiClient.get(\"/api/users/\");\n        return response.data;\n    },\n    getUserByTeamsId: async (teamsId)=>{\n        const response = await apiClient.get(`/api/users/?teams_id=${teamsId}`);\n        return response.data.length > 0 ? response.data[0] : null;\n    },\n    getTeamMembers: async ()=>{\n        const response = await apiClient.get(\"/api/teams-auth/team-members/\");\n        return response.data;\n    },\n    // Department methods\n    getDepartments: async ()=>{\n        const response = await apiClient.get(\"/api/departments/\");\n        return response.data;\n    },\n    // Business Unit methods\n    getBusinessUnits: async ()=>{\n        const response = await apiClient.get(\"/api/business-units/\");\n        return response.data;\n    },\n    getOKRBusinessUnits: async (okrId)=>{\n        const response = await apiClient.get(`/api/okrs/${okrId}/business_units/`);\n        return response.data;\n    },\n    assignBusinessUnits: async (okrId, businessUnitIds)=>{\n        const response = await apiClient.post(`/api/okrs/${okrId}/assign_business_units/`, businessUnitIds);\n        return response.data;\n    },\n    // OKR methods\n    getOKRs: async (params = {})=>{\n        const response = await apiClient.get(\"/api/okrs/\", {\n            params\n        });\n        return response.data;\n    },\n    getOKRAssignedUsers: async (okrId)=>{\n        const response = await apiClient.get(`/api/okrs/${okrId}/assigned_users/`);\n        return response.data;\n    },\n    createOKR: async (data)=>{\n        const response = await apiClient.post(\"/api/okrs/\", data);\n        return response.data;\n    },\n    updateOKR: async (id, data)=>{\n        const response = await apiClient.put(`/api/okrs/${id}/`, data);\n        return response.data;\n    },\n    deleteOKR: async (id)=>{\n        await apiClient.delete(`/api/okrs/${id}/`);\n    }\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (api);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFBVXNCLElBQUksQ0FBQyxjQUFjRTtRQUNwRCxPQUFPUCxTQUFTTyxJQUFJO0lBQ3RCO0lBRUEwQixXQUFXLE9BQU9DLElBQUkzQjtRQUNwQixNQUFNUCxXQUFXLE1BQU1qQixVQUFVaUMsR0FBRyxDQUFDLENBQUMsVUFBVSxFQUFFa0IsR0FBRyxDQUFDLENBQUMsRUFBRTNCO1FBQ3pELE9BQU9QLFNBQVNPLElBQUk7SUFDdEI7SUFFQTRCLFdBQVcsT0FBT0Q7UUFDaEIsTUFBTW5ELFVBQVVrQyxNQUFNLENBQUMsQ0FBQyxVQUFVLEVBQUVpQixHQUFHLENBQUMsQ0FBQztJQUMzQztBQUNGLEVBQUU7QUFFRixpRUFBZXBCLEdBQUdBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9va3ItdHJlZS1mcm9udGVuZC8uL2xpYi9hcGkuanM/NDU0MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xyXG5cclxuY29uc3QgQVBJX0JBU0VfVVJMID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBJX1VSTCB8fCAnaHR0cDovLzEyNy4wLjAuMTo4MDAwJztcclxuXHJcbi8vIENyZWF0ZSBheGlvcyBpbnN0YW5jZSB3aXRoIGRlZmF1bHQgY29uZmlnXHJcbmNvbnN0IGFwaUNsaWVudCA9IGF4aW9zLmNyZWF0ZSh7XHJcbiAgYmFzZVVSTDogQVBJX0JBU0VfVVJMLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgfSxcclxuICB0aW1lb3V0OiAxNTAwMCxcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBnZXQgdGhlIGN1cnJlbnQgdG9rZW5cclxuY29uc3QgZ2V0VG9rZW4gPSAoKSA9PiB7XHJcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjY2Vzc1Rva2VuJyk7XHJcbiAgfVxyXG4gIHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuLy8gQWRkIHJlcXVlc3QgaW50ZXJjZXB0b3IgZm9yIGF1dGggaGVhZGVyXHJcbmFwaUNsaWVudC5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoXHJcbiAgKGNvbmZpZykgPT4ge1xyXG4gICAgY29uc3QgdG9rZW4gPSBnZXRUb2tlbigpO1xyXG4gICAgaWYgKHRva2VuKSB7XHJcbiAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSBgQmVhcmVyICR7dG9rZW59YDtcclxuICAgIH1cclxuICAgIHJldHVybiBjb25maWc7XHJcbiAgfSxcclxuICAoZXJyb3IpID0+IHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgfVxyXG4pO1xyXG5cclxuLy8gQWRkIHJlc3BvbnNlIGludGVyY2VwdG9yIGZvciBlcnJvciBoYW5kbGluZ1xyXG5hcGlDbGllbnQuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShcclxuICAocmVzcG9uc2UpID0+IHJlc3BvbnNlLFxyXG4gIGFzeW5jIChlcnJvcikgPT4ge1xyXG4gICAgY29uc3Qgb3JpZ2luYWxSZXF1ZXN0ID0gZXJyb3IuY29uZmlnO1xyXG5cclxuICAgIC8vIElmIHRoZSBlcnJvciBpcyA0MDEgYW5kIHdlIGhhdmVuJ3QgcmV0cmllZCB5ZXRcclxuICAgIGlmIChlcnJvci5yZXNwb25zZT8uc3RhdHVzID09PSA0MDEgJiYgIW9yaWdpbmFsUmVxdWVzdC5fcmV0cnkpIHtcclxuICAgICAgb3JpZ2luYWxSZXF1ZXN0Ll9yZXRyeSA9IHRydWU7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIFRyeSB0byByZWZyZXNoIHRoZSB0b2tlblxyXG4gICAgICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWZyZXNoVG9rZW4nKTtcclxuICAgICAgICBpZiAocmVmcmVzaFRva2VuKSB7XHJcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoYCR7QVBJX0JBU0VfVVJMfS9hcGkvYXV0aC9yZWZyZXNoL2AsIHtcclxuICAgICAgICAgICAgcmVmcmVzaDogcmVmcmVzaFRva2VuXHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5hY2Nlc3MpIHtcclxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIG5ldyB0b2tlblxyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWNjZXNzVG9rZW4nLCByZXNwb25zZS5kYXRhLmFjY2Vzcyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgQXV0aG9yaXphdGlvbiBoZWFkZXJcclxuICAgICAgICAgICAgb3JpZ2luYWxSZXF1ZXN0LmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHtyZXNwb25zZS5kYXRhLmFjY2Vzc31gO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gUmV0cnkgdGhlIG9yaWdpbmFsIHJlcXVlc3RcclxuICAgICAgICAgICAgcmV0dXJuIGFwaUNsaWVudChvcmlnaW5hbFJlcXVlc3QpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAocmVmcmVzaEVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignVG9rZW4gcmVmcmVzaCBmYWlsZWQ6JywgcmVmcmVzaEVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICB9XHJcbik7XHJcblxyXG4vLyBIZWxwZXIgZnVuY3Rpb24gZm9yIGNoZWNraW5nIGJhY2tlbmQgY29ubmVjdGlvblxyXG5jb25zdCBjaGVja0Nvbm5lY3Rpb24gPSBhc3luYyAoKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IGFwaUNsaWVudC5nZXQoJy9hcGkvYXV0aC9tZS8nKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdCYWNrZW5kIGNvbm5lY3Rpb24gZmFpbGVkOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBFeHBvcnQgdGhlIGNvbmZpZ3VyZWQgY2xpZW50IGFuZCB1dGlsaXRpZXNcclxuZXhwb3J0IGNvbnN0IGFwaSA9IHtcclxuICBnZXQ6ICh1cmwpID0+IGFwaUNsaWVudC5nZXQodXJsKSxcclxuICBwb3N0OiAodXJsLCBkYXRhKSA9PiBhcGlDbGllbnQucG9zdCh1cmwsIGRhdGEpLFxyXG4gIHB1dDogKHVybCwgZGF0YSkgPT4gYXBpQ2xpZW50LnB1dCh1cmwsIGRhdGEpLFxyXG4gIGRlbGV0ZTogKHVybCkgPT4gYXBpQ2xpZW50LmRlbGV0ZSh1cmwpLFxyXG4gIGNoZWNrQ29ubmVjdGlvbixcclxuICBcclxuICAvLyBVc2VyIG1ldGhvZHNcclxuICBnZXRVc2VyczogYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuZ2V0KCcvYXBpL3VzZXJzLycpO1xyXG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XHJcbiAgfSxcclxuXHJcbiAgZ2V0VXNlckJ5VGVhbXNJZDogYXN5bmMgKHRlYW1zSWQpID0+IHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpQ2xpZW50LmdldChgL2FwaS91c2Vycy8/dGVhbXNfaWQ9JHt0ZWFtc0lkfWApO1xyXG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEubGVuZ3RoID4gMCA/IHJlc3BvbnNlLmRhdGFbMF0gOiBudWxsO1xyXG4gIH0sXHJcblxyXG4gIGdldFRlYW1NZW1iZXJzOiBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5nZXQoJy9hcGkvdGVhbXMtYXV0aC90ZWFtLW1lbWJlcnMvJyk7XHJcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICB9LFxyXG5cclxuICAvLyBEZXBhcnRtZW50IG1ldGhvZHNcclxuICBnZXREZXBhcnRtZW50czogYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuZ2V0KCcvYXBpL2RlcGFydG1lbnRzLycpO1xyXG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XHJcbiAgfSxcclxuICBcclxuICAvLyBCdXNpbmVzcyBVbml0IG1ldGhvZHNcclxuICBnZXRCdXNpbmVzc1VuaXRzOiBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5nZXQoJy9hcGkvYnVzaW5lc3MtdW5pdHMvJyk7XHJcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICB9LFxyXG4gIFxyXG4gIGdldE9LUkJ1c2luZXNzVW5pdHM6IGFzeW5jIChva3JJZCkgPT4ge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuZ2V0KGAvYXBpL29rcnMvJHtva3JJZH0vYnVzaW5lc3NfdW5pdHMvYCk7XHJcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICB9LFxyXG4gIFxyXG4gIGFzc2lnbkJ1c2luZXNzVW5pdHM6IGFzeW5jIChva3JJZCwgYnVzaW5lc3NVbml0SWRzKSA9PiB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5wb3N0KGAvYXBpL29rcnMvJHtva3JJZH0vYXNzaWduX2J1c2luZXNzX3VuaXRzL2AsIGJ1c2luZXNzVW5pdElkcyk7XHJcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICB9LFxyXG4gIFxyXG4gIC8vIE9LUiBtZXRob2RzXHJcbiAgZ2V0T0tSczogYXN5bmMgKHBhcmFtcyA9IHt9KSA9PiB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5nZXQoJy9hcGkvb2tycy8nLCB7IHBhcmFtcyB9KTtcclxuICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xyXG4gIH0sXHJcbiAgXHJcbiAgZ2V0T0tSQXNzaWduZWRVc2VyczogYXN5bmMgKG9rcklkKSA9PiB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5nZXQoYC9hcGkvb2tycy8ke29rcklkfS9hc3NpZ25lZF91c2Vycy9gKTtcclxuICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xyXG4gIH0sXHJcbiAgXHJcbiAgY3JlYXRlT0tSOiBhc3luYyAoZGF0YSkgPT4ge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQucG9zdCgnL2FwaS9va3JzLycsIGRhdGEpO1xyXG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XHJcbiAgfSxcclxuICBcclxuICB1cGRhdGVPS1I6IGFzeW5jIChpZCwgZGF0YSkgPT4ge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQucHV0KGAvYXBpL29rcnMvJHtpZH0vYCwgZGF0YSk7XHJcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICB9LFxyXG4gIFxyXG4gIGRlbGV0ZU9LUjogYXN5bmMgKGlkKSA9PiB7XHJcbiAgICBhd2FpdCBhcGlDbGllbnQuZGVsZXRlKGAvYXBpL29rcnMvJHtpZH0vYCk7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXBpOyJdLCJuYW1lcyI6WyJheGlvcyIsIkFQSV9CQVNFX1VSTCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19BUElfVVJMIiwiYXBpQ2xpZW50IiwiY3JlYXRlIiwiYmFzZVVSTCIsImhlYWRlcnMiLCJ0aW1lb3V0IiwiZ2V0VG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiaW50ZXJjZXB0b3JzIiwicmVxdWVzdCIsInVzZSIsImNvbmZpZyIsInRva2VuIiwiQXV0aG9yaXphdGlvbiIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsInJlc3BvbnNlIiwib3JpZ2luYWxSZXF1ZXN0Iiwic3RhdHVzIiwiX3JldHJ5IiwicmVmcmVzaFRva2VuIiwicG9zdCIsInJlZnJlc2giLCJkYXRhIiwiYWNjZXNzIiwic2V0SXRlbSIsInJlZnJlc2hFcnJvciIsImNvbnNvbGUiLCJjaGVja0Nvbm5lY3Rpb24iLCJnZXQiLCJhcGkiLCJ1cmwiLCJwdXQiLCJkZWxldGUiLCJnZXRVc2VycyIsImdldFVzZXJCeVRlYW1zSWQiLCJ0ZWFtc0lkIiwibGVuZ3RoIiwiZ2V0VGVhbU1lbWJlcnMiLCJnZXREZXBhcnRtZW50cyIsImdldEJ1c2luZXNzVW5pdHMiLCJnZXRPS1JCdXNpbmVzc1VuaXRzIiwib2tySWQiLCJhc3NpZ25CdXNpbmVzc1VuaXRzIiwiYnVzaW5lc3NVbml0SWRzIiwiZ2V0T0tScyIsInBhcmFtcyIsImdldE9LUkFzc2lnbmVkVXNlcnMiLCJjcmVhdGVPS1IiLCJ1cGRhdGVPS1IiLCJpZCIsImRlbGV0ZU9LUiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/api.js\n");

/***/ }),

/***/ "./lib/teamsAuth.js":
/*!**************************!*\
  !*** ./lib/teamsAuth.js ***!
  \**************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   configureApiAuth: () => (/* binding */ configureApiAuth),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getTeamsContext: () => (/* binding */ getTeamsContext),\n/* harmony export */   teamsAuth: () => (/* binding */ teamsAuth),\n/* harmony export */   useTeamsAuth: () => (/* binding */ useTeamsAuth)\n/* harmony export */ });\n/* harmony import */ var _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/teams-js */ \"@microsoft/teams-js\");\n/* harmony import */ var _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _teamsHelpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./teamsHelpers */ \"./lib/teamsHelpers.js\");\n/* harmony import */ var _api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./api */ \"./lib/api.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_api__WEBPACK_IMPORTED_MODULE_2__]);\n_api__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n/**\r\n * Teams authentication service for handling SSO with Microsoft Teams\r\n * Enhanced version with better desktop/mobile client handling\r\n */ const teamsAuth = {\n    isAuthenticated: false,\n    user: null,\n    token: null,\n    /**\r\n   * Initialize Teams authentication\r\n   */ async initialize () {\n        try {\n            await (0,_teamsHelpers__WEBPACK_IMPORTED_MODULE_1__.initializeTeams)();\n            return true;\n        } catch (error) {\n            console.error(\"Failed to initialize Teams auth:\", error);\n            return false;\n        }\n    },\n    /**\r\n   * Get Teams SSO token and authenticate with backend\r\n   */ async login () {\n        try {\n            // Get Teams SSO token\n            const teamsSsoToken = await this.getTeamsToken();\n            if (!teamsSsoToken) {\n                throw new Error(\"Failed to obtain Teams SSO token\");\n            }\n            // Exchange Teams token for our app's JWT token with backend\n            const authResponse = await _api__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(\"/auth/teams/\", {\n                token: teamsSsoToken\n            });\n            // Save authentication data\n            this.token = authResponse.data.tokens.access;\n            this.refreshToken = authResponse.data.tokens.refresh;\n            this.user = authResponse.data.user;\n            this.isAuthenticated = true;\n            // Store tokens in localStorage (consider using secure storage in production)\n            localStorage.setItem(\"accessToken\", this.token);\n            localStorage.setItem(\"refreshToken\", this.refreshToken);\n            localStorage.setItem(\"user\", JSON.stringify(this.user));\n            return this.user;\n        } catch (error) {\n            console.error(\"Teams authentication failed:\", error);\n            this.isAuthenticated = false;\n            return null;\n        }\n    },\n    /**\r\n   * Get Teams SSO token with platform-specific optimizations\r\n   */ async getTeamsToken () {\n        try {\n            // Make sure Teams SDK is initialized\n            await _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__.app.initialize();\n            // Get client information to determine best authentication approach\n            let clientType = \"unknown\";\n            try {\n                const context = await _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__.app.getContext();\n                clientType = context.hostClientType || \"unknown\";\n                console.log(`Teams client type detected: ${clientType}`);\n            } catch (contextError) {\n                console.warn(\"Could not determine Teams client type:\", contextError);\n            }\n            // First try silent token acquisition - works best on all platforms\n            try {\n                console.log(\"Attempting silent token acquisition...\");\n                const silentToken = await _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__.authentication.getAuthToken({\n                    resources: [\n                        window.location.origin\n                    ]\n                });\n                console.log(\"Silent token acquisition succeeded\");\n                return silentToken;\n            } catch (silentError) {\n                console.log(\"Silent token acquisition failed:\", silentError);\n                // For desktop client, try the authenticate method with modern Promise approach first\n                if (clientType === \"desktop\") {\n                    try {\n                        console.log(\"Using desktop-specific authenticate method (Promise-based)\");\n                        const desktopToken = await _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__.authentication.authenticate({\n                            url: `${window.location.origin}/auth-start`,\n                            width: 600,\n                            height: 535\n                        });\n                        console.log(\"Desktop authentication succeeded with Promise approach\");\n                        return desktopToken;\n                    } catch (desktopError) {\n                        console.error(\"Desktop Promise authentication failed:\", desktopError);\n                    // Fall through to callback approach\n                    }\n                }\n                // Fallback to callback approach for all clients\n                console.log(\"Attempting authentication with callback approach\");\n                return new Promise((resolve, reject)=>{\n                    _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__.authentication.authenticate({\n                        url: `${window.location.origin}/auth-start`,\n                        width: 600,\n                        height: 535,\n                        successCallback: (token)=>{\n                            console.log(\"Authentication callback succeeded\");\n                            resolve(token);\n                        },\n                        failureCallback: (error)=>{\n                            console.error(\"Authentication callback failed\", error);\n                            reject(error);\n                        }\n                    });\n                });\n            }\n        } catch (error) {\n            console.error(\"All authentication methods failed:\", error);\n            return null;\n        }\n    },\n    /**\r\n   * Check if user is authenticated (from localStorage or session)\r\n   */ checkAuth () {\n        const token = localStorage.getItem(\"accessToken\");\n        const user = localStorage.getItem(\"user\");\n        if (token && user) {\n            this.token = token;\n            try {\n                this.user = JSON.parse(user);\n                this.isAuthenticated = true;\n                return true;\n            } catch (e) {\n                console.error(\"Error parsing user data:\", e);\n                this.logout(); // Clear invalid data\n            }\n        }\n        return false;\n    },\n    /**\r\n   * Log out current user\r\n   */ logout () {\n        this.token = null;\n        this.refreshToken = null;\n        this.user = null;\n        this.isAuthenticated = false;\n        localStorage.removeItem(\"accessToken\");\n        localStorage.removeItem(\"refreshToken\");\n        localStorage.removeItem(\"user\");\n    },\n    /**\r\n   * Refresh token if expired\r\n   */ async refreshAuth () {\n        try {\n            const refreshToken = localStorage.getItem(\"refreshToken\");\n            if (!refreshToken) {\n                throw new Error(\"No refresh token available\");\n            }\n            const response = await _api__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(\"/token/refresh/\", {\n                refresh: refreshToken\n            });\n            this.token = response.data.access;\n            localStorage.setItem(\"accessToken\", this.token);\n            return true;\n        } catch (error) {\n            console.error(\"Token refresh failed:\", error);\n            this.logout();\n            return false;\n        }\n    }\n};\n/**\r\n * Configure API client with authentication token\r\n */ const configureApiAuth = ()=>{\n    const token = localStorage.getItem(\"accessToken\");\n    // Instead of trying to access api.defaults.headers, set the token in localStorage\n    // The api.js interceptor will pick up the token from localStorage automatically\n    if (token) {\n        localStorage.setItem(\"accessToken\", token);\n    // No need to set api.defaults.headers directly\n    } else {\n        localStorage.removeItem(\"accessToken\");\n    }\n};\n/**\r\n * Hook to ensure user is authenticated in Teams context\r\n */ const useTeamsAuth = async ()=>{\n    // Check if already authenticated\n    if (teamsAuth.checkAuth()) {\n        configureApiAuth();\n        return teamsAuth.user;\n    }\n    // Initialize Teams and authenticate\n    await teamsAuth.initialize();\n    const user = await teamsAuth.login();\n    if (user) {\n        configureApiAuth();\n    }\n    return user;\n};\n/**\r\n * Get the current Teams context if available\r\n * @returns {Promise<Object|null>} The Teams context object or null if not in Teams\r\n */ const getTeamsContext = async ()=>{\n    try {\n        if (!_microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__.app.isInitialized()) {\n            await (0,_teamsHelpers__WEBPACK_IMPORTED_MODULE_1__.initializeTeams)();\n        }\n        const context = await _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_0__.app.getContext();\n        return context;\n    } catch (error) {\n        console.warn(\"Not in Teams context:\", error);\n        return null;\n    }\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (teamsAuth);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MUIsTUFBTUYsT0FBTyxNQUFNRixVQUFVTyxLQUFLO0lBRWxDLElBQUlMLE1BQU07UUFDUnFEO0lBQ0Y7SUFFQSxPQUFPckQ7QUFDVCxFQUFFO0FBRUY7OztDQUdDLEdBQ00sTUFBTXVELGtCQUFrQjtJQUM3QixJQUFJO1FBQ0YsSUFBSSxDQUFDN0Qsb0RBQUdBLENBQUM4RCxhQUFhLElBQUk7WUFDeEIsTUFBTTVELDhEQUFlQTtRQUN2QjtRQUNBLE1BQU15QixVQUFVLE1BQU0zQixvREFBR0EsQ0FBQzRCLFVBQVU7UUFDcEMsT0FBT0Q7SUFDVCxFQUFFLE9BQU9sQixPQUFPO1FBQ2RDLFFBQVFzQixJQUFJLENBQUMseUJBQXlCdkI7UUFDdEMsT0FBTztJQUNUO0FBQ0YsRUFBRTtBQUVGLGlFQUFlTCxTQUFTQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2tyLXRyZWUtZnJvbnRlbmQvLi9saWIvdGVhbXNBdXRoLmpzP2RmMWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXBwLCBhdXRoZW50aWNhdGlvbiB9IGZyb20gJ0BtaWNyb3NvZnQvdGVhbXMtanMnO1xyXG5pbXBvcnQgeyBpbml0aWFsaXplVGVhbXMgfSBmcm9tICcuL3RlYW1zSGVscGVycyc7XHJcbmltcG9ydCBhcGkgZnJvbSAnLi9hcGknO1xyXG5cclxuLyoqXHJcbiAqIFRlYW1zIGF1dGhlbnRpY2F0aW9uIHNlcnZpY2UgZm9yIGhhbmRsaW5nIFNTTyB3aXRoIE1pY3Jvc29mdCBUZWFtc1xyXG4gKiBFbmhhbmNlZCB2ZXJzaW9uIHdpdGggYmV0dGVyIGRlc2t0b3AvbW9iaWxlIGNsaWVudCBoYW5kbGluZ1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHRlYW1zQXV0aCA9IHtcclxuICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxyXG4gIHVzZXI6IG51bGwsXHJcbiAgdG9rZW46IG51bGwsXHJcbiAgXHJcbiAgLyoqXHJcbiAgICogSW5pdGlhbGl6ZSBUZWFtcyBhdXRoZW50aWNhdGlvblxyXG4gICAqL1xyXG4gIGFzeW5jIGluaXRpYWxpemUoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBpbml0aWFsaXplVGVhbXMoKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBUZWFtcyBhdXRoOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgXHJcbiAgLyoqXHJcbiAgICogR2V0IFRlYW1zIFNTTyB0b2tlbiBhbmQgYXV0aGVudGljYXRlIHdpdGggYmFja2VuZFxyXG4gICAqL1xyXG4gIGFzeW5jIGxvZ2luKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gR2V0IFRlYW1zIFNTTyB0b2tlblxyXG4gICAgICBjb25zdCB0ZWFtc1Nzb1Rva2VuID0gYXdhaXQgdGhpcy5nZXRUZWFtc1Rva2VuKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXRlYW1zU3NvVG9rZW4pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBvYnRhaW4gVGVhbXMgU1NPIHRva2VuJyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEV4Y2hhbmdlIFRlYW1zIHRva2VuIGZvciBvdXIgYXBwJ3MgSldUIHRva2VuIHdpdGggYmFja2VuZFxyXG4gICAgICBjb25zdCBhdXRoUmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdCgnL2F1dGgvdGVhbXMvJywge1xyXG4gICAgICAgIHRva2VuOiB0ZWFtc1Nzb1Rva2VuXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgLy8gU2F2ZSBhdXRoZW50aWNhdGlvbiBkYXRhXHJcbiAgICAgIHRoaXMudG9rZW4gPSBhdXRoUmVzcG9uc2UuZGF0YS50b2tlbnMuYWNjZXNzO1xyXG4gICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IGF1dGhSZXNwb25zZS5kYXRhLnRva2Vucy5yZWZyZXNoO1xyXG4gICAgICB0aGlzLnVzZXIgPSBhdXRoUmVzcG9uc2UuZGF0YS51c2VyO1xyXG4gICAgICB0aGlzLmlzQXV0aGVudGljYXRlZCA9IHRydWU7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTdG9yZSB0b2tlbnMgaW4gbG9jYWxTdG9yYWdlIChjb25zaWRlciB1c2luZyBzZWN1cmUgc3RvcmFnZSBpbiBwcm9kdWN0aW9uKVxyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWNjZXNzVG9rZW4nLCB0aGlzLnRva2VuKTtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3JlZnJlc2hUb2tlbicsIHRoaXMucmVmcmVzaFRva2VuKTtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXInLCBKU09OLnN0cmluZ2lmeSh0aGlzLnVzZXIpKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB0aGlzLnVzZXI7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdUZWFtcyBhdXRoZW50aWNhdGlvbiBmYWlsZWQ6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLmlzQXV0aGVudGljYXRlZCA9IGZhbHNlO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9LFxyXG4gIC8qKlxyXG4gICAqIEdldCBUZWFtcyBTU08gdG9rZW4gd2l0aCBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6YXRpb25zXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0VGVhbXNUb2tlbigpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIE1ha2Ugc3VyZSBUZWFtcyBTREsgaXMgaW5pdGlhbGl6ZWRcclxuICAgICAgYXdhaXQgYXBwLmluaXRpYWxpemUoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEdldCBjbGllbnQgaW5mb3JtYXRpb24gdG8gZGV0ZXJtaW5lIGJlc3QgYXV0aGVudGljYXRpb24gYXBwcm9hY2hcclxuICAgICAgbGV0IGNsaWVudFR5cGUgPSAndW5rbm93bic7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGF3YWl0IGFwcC5nZXRDb250ZXh0KCk7XHJcbiAgICAgICAgY2xpZW50VHlwZSA9IGNvbnRleHQuaG9zdENsaWVudFR5cGUgfHwgJ3Vua25vd24nO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBUZWFtcyBjbGllbnQgdHlwZSBkZXRlY3RlZDogJHtjbGllbnRUeXBlfWApO1xyXG4gICAgICB9IGNhdGNoIChjb250ZXh0RXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBkZXRlcm1pbmUgVGVhbXMgY2xpZW50IHR5cGU6JywgY29udGV4dEVycm9yKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gRmlyc3QgdHJ5IHNpbGVudCB0b2tlbiBhY3F1aXNpdGlvbiAtIHdvcmtzIGJlc3Qgb24gYWxsIHBsYXRmb3Jtc1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIHNpbGVudCB0b2tlbiBhY3F1aXNpdGlvbi4uLicpO1xyXG4gICAgICAgIGNvbnN0IHNpbGVudFRva2VuID0gYXdhaXQgYXV0aGVudGljYXRpb24uZ2V0QXV0aFRva2VuKHtcclxuICAgICAgICAgIHJlc291cmNlczogW3dpbmRvdy5sb2NhdGlvbi5vcmlnaW5dXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1NpbGVudCB0b2tlbiBhY3F1aXNpdGlvbiBzdWNjZWVkZWQnKTtcclxuICAgICAgICByZXR1cm4gc2lsZW50VG9rZW47XHJcbiAgICAgIH0gY2F0Y2ggKHNpbGVudEVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1NpbGVudCB0b2tlbiBhY3F1aXNpdGlvbiBmYWlsZWQ6Jywgc2lsZW50RXJyb3IpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEZvciBkZXNrdG9wIGNsaWVudCwgdHJ5IHRoZSBhdXRoZW50aWNhdGUgbWV0aG9kIHdpdGggbW9kZXJuIFByb21pc2UgYXBwcm9hY2ggZmlyc3RcclxuICAgICAgICBpZiAoY2xpZW50VHlwZSA9PT0gJ2Rlc2t0b3AnKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnVXNpbmcgZGVza3RvcC1zcGVjaWZpYyBhdXRoZW50aWNhdGUgbWV0aG9kIChQcm9taXNlLWJhc2VkKScpO1xyXG4gICAgICAgICAgICBjb25zdCBkZXNrdG9wVG9rZW4gPSBhd2FpdCBhdXRoZW50aWNhdGlvbi5hdXRoZW50aWNhdGUoe1xyXG4gICAgICAgICAgICAgIHVybDogYCR7d2luZG93LmxvY2F0aW9uLm9yaWdpbn0vYXV0aC1zdGFydGAsXHJcbiAgICAgICAgICAgICAgd2lkdGg6IDYwMCxcclxuICAgICAgICAgICAgICBoZWlnaHQ6IDUzNVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Rlc2t0b3AgYXV0aGVudGljYXRpb24gc3VjY2VlZGVkIHdpdGggUHJvbWlzZSBhcHByb2FjaCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGVza3RvcFRva2VuO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZGVza3RvcEVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Rlc2t0b3AgUHJvbWlzZSBhdXRoZW50aWNhdGlvbiBmYWlsZWQ6JywgZGVza3RvcEVycm9yKTtcclxuICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIGNhbGxiYWNrIGFwcHJvYWNoXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEZhbGxiYWNrIHRvIGNhbGxiYWNrIGFwcHJvYWNoIGZvciBhbGwgY2xpZW50c1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIGF1dGhlbnRpY2F0aW9uIHdpdGggY2FsbGJhY2sgYXBwcm9hY2gnKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgYXV0aGVudGljYXRpb24uYXV0aGVudGljYXRlKHtcclxuICAgICAgICAgICAgdXJsOiBgJHt3aW5kb3cubG9jYXRpb24ub3JpZ2lufS9hdXRoLXN0YXJ0YCxcclxuICAgICAgICAgICAgd2lkdGg6IDYwMCxcclxuICAgICAgICAgICAgaGVpZ2h0OiA1MzUsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3NDYWxsYmFjazogKHRva2VuKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBdXRoZW50aWNhdGlvbiBjYWxsYmFjayBzdWNjZWVkZWRcIik7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZSh0b2tlbik7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZhaWx1cmVDYWxsYmFjazogKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkF1dGhlbnRpY2F0aW9uIGNhbGxiYWNrIGZhaWxlZFwiLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0FsbCBhdXRoZW50aWNhdGlvbiBtZXRob2RzIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgICAvKipcclxuICAgKiBDaGVjayBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgKGZyb20gbG9jYWxTdG9yYWdlIG9yIHNlc3Npb24pXHJcbiAgICovXHJcbiAgY2hlY2tBdXRoKCkge1xyXG4gICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWNjZXNzVG9rZW4nKTtcclxuICAgIGNvbnN0IHVzZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpO1xyXG4gICAgXHJcbiAgICBpZiAodG9rZW4gJiYgdXNlcikge1xyXG4gICAgICB0aGlzLnRva2VuID0gdG9rZW47XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgdGhpcy51c2VyID0gSlNPTi5wYXJzZSh1c2VyKTtcclxuICAgICAgICB0aGlzLmlzQXV0aGVudGljYXRlZCA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIHVzZXIgZGF0YTonLCBlKTtcclxuICAgICAgICB0aGlzLmxvZ291dCgpOyAvLyBDbGVhciBpbnZhbGlkIGRhdGFcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfSxcclxuICBcclxuICAvKipcclxuICAgKiBMb2cgb3V0IGN1cnJlbnQgdXNlclxyXG4gICAqL1xyXG4gIGxvZ291dCgpIHtcclxuICAgIHRoaXMudG9rZW4gPSBudWxsO1xyXG4gICAgdGhpcy5yZWZyZXNoVG9rZW4gPSBudWxsO1xyXG4gICAgdGhpcy51c2VyID0gbnVsbDtcclxuICAgIHRoaXMuaXNBdXRoZW50aWNhdGVkID0gZmFsc2U7XHJcbiAgICBcclxuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhY2Nlc3NUb2tlbicpO1xyXG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3JlZnJlc2hUb2tlbicpO1xyXG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXInKTtcclxuICB9LFxyXG4gIFxyXG4gIC8qKlxyXG4gICAqIFJlZnJlc2ggdG9rZW4gaWYgZXhwaXJlZFxyXG4gICAqL1xyXG4gIGFzeW5jIHJlZnJlc2hBdXRoKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVmcmVzaFRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlZnJlc2hUb2tlbicpO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFyZWZyZXNoVG9rZW4pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHJlZnJlc2ggdG9rZW4gYXZhaWxhYmxlJyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLnBvc3QoJy90b2tlbi9yZWZyZXNoLycsIHtcclxuICAgICAgICByZWZyZXNoOiByZWZyZXNoVG9rZW5cclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLnRva2VuID0gcmVzcG9uc2UuZGF0YS5hY2Nlc3M7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY2Nlc3NUb2tlbicsIHRoaXMudG9rZW4pO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdUb2tlbiByZWZyZXNoIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgIHRoaXMubG9nb3V0KCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ29uZmlndXJlIEFQSSBjbGllbnQgd2l0aCBhdXRoZW50aWNhdGlvbiB0b2tlblxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGNvbmZpZ3VyZUFwaUF1dGggPSAoKSA9PiB7XHJcbiAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWNjZXNzVG9rZW4nKTtcclxuICBcclxuICAvLyBJbnN0ZWFkIG9mIHRyeWluZyB0byBhY2Nlc3MgYXBpLmRlZmF1bHRzLmhlYWRlcnMsIHNldCB0aGUgdG9rZW4gaW4gbG9jYWxTdG9yYWdlXHJcbiAgLy8gVGhlIGFwaS5qcyBpbnRlcmNlcHRvciB3aWxsIHBpY2sgdXAgdGhlIHRva2VuIGZyb20gbG9jYWxTdG9yYWdlIGF1dG9tYXRpY2FsbHlcclxuICBpZiAodG9rZW4pIHtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY2Nlc3NUb2tlbicsIHRva2VuKTtcclxuICAgIC8vIE5vIG5lZWQgdG8gc2V0IGFwaS5kZWZhdWx0cy5oZWFkZXJzIGRpcmVjdGx5XHJcbiAgfSBlbHNlIHtcclxuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhY2Nlc3NUb2tlbicpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBIb29rIHRvIGVuc3VyZSB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgaW4gVGVhbXMgY29udGV4dFxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHVzZVRlYW1zQXV0aCA9IGFzeW5jICgpID0+IHtcclxuICAvLyBDaGVjayBpZiBhbHJlYWR5IGF1dGhlbnRpY2F0ZWRcclxuICBpZiAodGVhbXNBdXRoLmNoZWNrQXV0aCgpKSB7XHJcbiAgICBjb25maWd1cmVBcGlBdXRoKCk7XHJcbiAgICByZXR1cm4gdGVhbXNBdXRoLnVzZXI7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEluaXRpYWxpemUgVGVhbXMgYW5kIGF1dGhlbnRpY2F0ZVxyXG4gIGF3YWl0IHRlYW1zQXV0aC5pbml0aWFsaXplKCk7XHJcbiAgY29uc3QgdXNlciA9IGF3YWl0IHRlYW1zQXV0aC5sb2dpbigpO1xyXG4gIFxyXG4gIGlmICh1c2VyKSB7XHJcbiAgICBjb25maWd1cmVBcGlBdXRoKCk7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB1c2VyO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCB0aGUgY3VycmVudCBUZWFtcyBjb250ZXh0IGlmIGF2YWlsYWJsZVxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3R8bnVsbD59IFRoZSBUZWFtcyBjb250ZXh0IG9iamVjdCBvciBudWxsIGlmIG5vdCBpbiBUZWFtc1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGdldFRlYW1zQ29udGV4dCA9IGFzeW5jICgpID0+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFhcHAuaXNJbml0aWFsaXplZCgpKSB7XHJcbiAgICAgIGF3YWl0IGluaXRpYWxpemVUZWFtcygpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY29udGV4dCA9IGF3YWl0IGFwcC5nZXRDb250ZXh0KCk7XHJcbiAgICByZXR1cm4gY29udGV4dDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS53YXJuKCdOb3QgaW4gVGVhbXMgY29udGV4dDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB0ZWFtc0F1dGg7Il0sIm5hbWVzIjpbImFwcCIsImF1dGhlbnRpY2F0aW9uIiwiaW5pdGlhbGl6ZVRlYW1zIiwiYXBpIiwidGVhbXNBdXRoIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlciIsInRva2VuIiwiaW5pdGlhbGl6ZSIsImVycm9yIiwiY29uc29sZSIsImxvZ2luIiwidGVhbXNTc29Ub2tlbiIsImdldFRlYW1zVG9rZW4iLCJFcnJvciIsImF1dGhSZXNwb25zZSIsInBvc3QiLCJkYXRhIiwidG9rZW5zIiwiYWNjZXNzIiwicmVmcmVzaFRva2VuIiwicmVmcmVzaCIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwiY2xpZW50VHlwZSIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwiaG9zdENsaWVudFR5cGUiLCJsb2ciLCJjb250ZXh0RXJyb3IiLCJ3YXJuIiwic2lsZW50VG9rZW4iLCJnZXRBdXRoVG9rZW4iLCJyZXNvdXJjZXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsIm9yaWdpbiIsInNpbGVudEVycm9yIiwiZGVza3RvcFRva2VuIiwiYXV0aGVudGljYXRlIiwidXJsIiwid2lkdGgiLCJoZWlnaHQiLCJkZXNrdG9wRXJyb3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInN1Y2Nlc3NDYWxsYmFjayIsImZhaWx1cmVDYWxsYmFjayIsImNoZWNrQXV0aCIsImdldEl0ZW0iLCJwYXJzZSIsImUiLCJsb2dvdXQiLCJyZW1vdmVJdGVtIiwicmVmcmVzaEF1dGgiLCJyZXNwb25zZSIsImNvbmZpZ3VyZUFwaUF1dGgiLCJ1c2VUZWFtc0F1dGgiLCJnZXRUZWFtc0NvbnRleHQiLCJpc0luaXRpYWxpemVkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/teamsAuth.js\n");

/***/ }),

/***/ "./lib/teamsHelpers.js":
/*!*****************************!*\
  !*** ./lib/teamsHelpers.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getTeamsContext: () => (/* binding */ getTeamsContext),\n/* harmony export */   getThemeClassName: () => (/* binding */ getThemeClassName),\n/* harmony export */   initializeTeams: () => (/* binding */ initializeTeams),\n/* harmony export */   openTaskModule: () => (/* binding */ openTaskModule),\n/* harmony export */   registerTabConfigHandler: () => (/* binding */ registerTabConfigHandler),\n/* harmony export */   useTeamsContext: () => (/* binding */ useTeamsContext)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/teams-js */ \"@microsoft/teams-js\");\n/* harmony import */ var _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1__);\n\n\n/**\r\n * Initialize Microsoft Teams SDK\r\n * Now handles the case when running outside of Teams environment\r\n */ const initializeTeams = async ()=>{\n    try {\n        // Check if we're running in a browser environment\n        if (true) {\n            return false;\n        }\n        // Check if we're running within an iframe (likely Teams)\n        const isInIframe = window.self !== window.top;\n        if (isInIframe) {\n            // Likely in Teams, try to initialize\n            await _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1__.app.initialize();\n            return true;\n        } else {\n            // Not in Teams, return false without throwing an error\n            console.log(\"Not running in Teams context - SDK initialization skipped\");\n            return false;\n        }\n    } catch (error) {\n        // Some other initialization error occurred\n        console.error(\"Error initializing Microsoft Teams SDK:\", error);\n        return false;\n    }\n};\n/**\r\n * Get the current Teams context\r\n */ const getTeamsContext = async ()=>{\n    try {\n        const context = await _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1__.app.getContext();\n        return context;\n    } catch (error) {\n        console.error(\"Error getting Teams context:\", error);\n        return null;\n    }\n};\n/**\r\n * Custom hook to detect if we're running in Teams\r\n */ const useTeamsContext = ()=>{\n    const [isTeams, setIsTeams] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [context, setContext] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [theme, setTheme] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"default\");\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        const init = async ()=>{\n            try {\n                if (false) {}\n            } catch (error) {\n                console.log(\"Not running in Teams context or initialization error\");\n            } finally{\n                setLoading(false);\n            }\n        };\n        init();\n    }, []);\n    return {\n        isTeams,\n        context,\n        theme,\n        loading\n    };\n};\n/**\r\n * Register the config handler for configurable tabs\r\n */ const registerTabConfigHandler = (contentUrl, websiteUrl, entityId, name)=>{\n    _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1__.pages.config.registerOnSaveHandler((saveEvent)=>{\n        const settings = {\n            entityId,\n            contentUrl,\n            websiteUrl,\n            suggestedDisplayName: name\n        };\n        _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1__.pages.config.setConfig(settings);\n        saveEvent.notifySuccess();\n    });\n    // Enable the save button\n    _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1__.pages.config.setValidityState(true);\n};\n/**\r\n * Open a URL in a Teams task module (dialog)\r\n */ const openTaskModule = async (url, title, width, height)=>{\n    try {\n        const taskInfo = {\n            url,\n            title,\n            width,\n            height\n        };\n        await _microsoft_teams_js__WEBPACK_IMPORTED_MODULE_1__.pages.tasks.startTask(taskInfo);\n    } catch (error) {\n        console.error(\"Error opening task module:\", error);\n    }\n};\n/**\r\n * Get theme class name based on Teams theme\r\n */ const getThemeClassName = (theme)=>{\n    switch(theme){\n        case \"dark\":\n            return \"teams-dark-theme dark\";\n        case \"contrast\":\n            return \"teams-contrast-theme dark\";\n        case \"default\":\n        default:\n            return \"teams-light-theme\";\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdGVhbXNIZWxwZXJzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBNEM7QUFDSztBQUVqRDs7O0NBR0MsR0FDTSxNQUFNSSxrQkFBa0I7SUFDN0IsSUFBSTtRQUNGLGtEQUFrRDtRQUNsRCxJQUFJLElBQWtCLEVBQWE7WUFDakMsT0FBTztRQUNUO1FBRUEseURBQXlEO1FBQ3pELE1BQU1DLGFBQWFDLE9BQU9DLElBQUksS0FBS0QsT0FBT0UsR0FBRztRQUU3QyxJQUFJSCxZQUFZO1lBQ2QscUNBQXFDO1lBQ3JDLE1BQU1ILG9EQUFHQSxDQUFDTyxVQUFVO1lBQ3BCLE9BQU87UUFDVCxPQUFPO1lBQ0wsdURBQXVEO1lBQ3ZEQyxRQUFRQyxHQUFHLENBQUM7WUFDWixPQUFPO1FBQ1Q7SUFDRixFQUFFLE9BQU9DLE9BQU87UUFDZCwyQ0FBMkM7UUFDM0NGLFFBQVFFLEtBQUssQ0FBQywyQ0FBMkNBO1FBQ3pELE9BQU87SUFDVDtBQUNGLEVBQUU7QUFFRjs7Q0FFQyxHQUNNLE1BQU1DLGtCQUFrQjtJQUM3QixJQUFJO1FBQ0YsTUFBTUMsVUFBVSxNQUFNWixvREFBR0EsQ0FBQ2EsVUFBVTtRQUNwQyxPQUFPRDtJQUNULEVBQUUsT0FBT0YsT0FBTztRQUNkRixRQUFRRSxLQUFLLENBQUMsZ0NBQWdDQTtRQUM5QyxPQUFPO0lBQ1Q7QUFDRixFQUFFO0FBRUY7O0NBRUMsR0FDTSxNQUFNSSxrQkFBa0I7SUFDN0IsTUFBTSxDQUFDQyxTQUFTQyxXQUFXLEdBQUdsQiwrQ0FBUUEsQ0FBQztJQUN2QyxNQUFNLENBQUNjLFNBQVNLLFdBQVcsR0FBR25CLCtDQUFRQSxDQUFDO0lBQ3ZDLE1BQU0sQ0FBQ29CLE9BQU9DLFNBQVMsR0FBR3JCLCtDQUFRQSxDQUFDO0lBQ25DLE1BQU0sQ0FBQ3NCLFNBQVNDLFdBQVcsR0FBR3ZCLCtDQUFRQSxDQUFDO0lBRXZDQyxnREFBU0EsQ0FBQztRQUNSLE1BQU11QixPQUFPO1lBQ1gsSUFBSTtnQkFDRixJQUFJLEtBQWtCLEVBQWEsRUEwQmxDO1lBQ0gsRUFBRSxPQUFPWixPQUFPO2dCQUNkRixRQUFRQyxHQUFHLENBQUM7WUFDZCxTQUFVO2dCQUNSWSxXQUFXO1lBQ2I7UUFDRjtRQUVBQztJQUNGLEdBQUcsRUFBRTtJQUVMLE9BQU87UUFBRVA7UUFBU0g7UUFBU007UUFBT0U7SUFBUTtBQUM1QyxFQUFFO0FBRUY7O0NBRUMsR0FDTSxNQUFNTywyQkFBMkIsQ0FBQ0MsWUFBWUMsWUFBWUMsVUFBVUM7SUFDekU5QixzREFBS0EsQ0FBQytCLE1BQU0sQ0FBQ0MscUJBQXFCLENBQUMsQ0FBQ0M7UUFDbEMsTUFBTUMsV0FBVztZQUNmTDtZQUNBRjtZQUNBQztZQUNBTyxzQkFBc0JMO1FBQ3hCO1FBRUE5QixzREFBS0EsQ0FBQytCLE1BQU0sQ0FBQ0ssU0FBUyxDQUFDRjtRQUN2QkQsVUFBVUksYUFBYTtJQUN6QjtJQUVBLHlCQUF5QjtJQUN6QnJDLHNEQUFLQSxDQUFDK0IsTUFBTSxDQUFDTyxnQkFBZ0IsQ0FBQztBQUNoQyxFQUFFO0FBRUY7O0NBRUMsR0FDTSxNQUFNQyxpQkFBaUIsT0FBT0MsS0FBS0MsT0FBT0MsT0FBT0M7SUFDdEQsSUFBSTtRQUNGLE1BQU1DLFdBQVc7WUFDZko7WUFDQUM7WUFDQUM7WUFDQUM7UUFDRjtRQUVBLE1BQU0zQyxzREFBS0EsQ0FBQzZDLEtBQUssQ0FBQ0MsU0FBUyxDQUFDRjtJQUM5QixFQUFFLE9BQU9uQyxPQUFPO1FBQ2RGLFFBQVFFLEtBQUssQ0FBQyw4QkFBOEJBO0lBQzlDO0FBQ0YsRUFBRTtBQUVGOztDQUVDLEdBQ00sTUFBTXNDLG9CQUFvQixDQUFDOUI7SUFDaEMsT0FBUUE7UUFDTixLQUFLO1lBQ0gsT0FBTztRQUNULEtBQUs7WUFDSCxPQUFPO1FBQ1QsS0FBSztRQUNMO1lBQ0UsT0FBTztJQUNYO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL29rci10cmVlLWZyb250ZW5kLy4vbGliL3RlYW1zSGVscGVycy5qcz81YzEwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IGFwcCwgcGFnZXMgfSBmcm9tICdAbWljcm9zb2Z0L3RlYW1zLWpzJztcclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIE1pY3Jvc29mdCBUZWFtcyBTREtcclxuICogTm93IGhhbmRsZXMgdGhlIGNhc2Ugd2hlbiBydW5uaW5nIG91dHNpZGUgb2YgVGVhbXMgZW52aXJvbm1lbnRcclxuICovXHJcbmV4cG9ydCBjb25zdCBpbml0aWFsaXplVGVhbXMgPSBhc3luYyAoKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIENoZWNrIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSBicm93c2VyIGVudmlyb25tZW50XHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiB3ZSdyZSBydW5uaW5nIHdpdGhpbiBhbiBpZnJhbWUgKGxpa2VseSBUZWFtcylcclxuICAgIGNvbnN0IGlzSW5JZnJhbWUgPSB3aW5kb3cuc2VsZiAhPT0gd2luZG93LnRvcDtcclxuICAgIFxyXG4gICAgaWYgKGlzSW5JZnJhbWUpIHtcclxuICAgICAgLy8gTGlrZWx5IGluIFRlYW1zLCB0cnkgdG8gaW5pdGlhbGl6ZVxyXG4gICAgICBhd2FpdCBhcHAuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIE5vdCBpbiBUZWFtcywgcmV0dXJuIGZhbHNlIHdpdGhvdXQgdGhyb3dpbmcgYW4gZXJyb3JcclxuICAgICAgY29uc29sZS5sb2coJ05vdCBydW5uaW5nIGluIFRlYW1zIGNvbnRleHQgLSBTREsgaW5pdGlhbGl6YXRpb24gc2tpcHBlZCcpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIC8vIFNvbWUgb3RoZXIgaW5pdGlhbGl6YXRpb24gZXJyb3Igb2NjdXJyZWRcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBNaWNyb3NvZnQgVGVhbXMgU0RLOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IHRoZSBjdXJyZW50IFRlYW1zIGNvbnRleHRcclxuICovXHJcbmV4cG9ydCBjb25zdCBnZXRUZWFtc0NvbnRleHQgPSBhc3luYyAoKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCBhcHAuZ2V0Q29udGV4dCgpO1xyXG4gICAgcmV0dXJuIGNvbnRleHQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgVGVhbXMgY29udGV4dDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3VzdG9tIGhvb2sgdG8gZGV0ZWN0IGlmIHdlJ3JlIHJ1bm5pbmcgaW4gVGVhbXNcclxuICovXHJcbmV4cG9ydCBjb25zdCB1c2VUZWFtc0NvbnRleHQgPSAoKSA9PiB7XHJcbiAgY29uc3QgW2lzVGVhbXMsIHNldElzVGVhbXNdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtjb250ZXh0LCBzZXRDb250ZXh0XSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFt0aGVtZSwgc2V0VGhlbWVdID0gdXNlU3RhdGUoJ2RlZmF1bHQnKTtcclxuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGNvbnN0IGluaXQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAvLyBPbmx5IGluaXRpYWxpemUgaW4gYnJvd3NlciBlbnZpcm9ubWVudFxyXG4gICAgICAgICAgY29uc3QgaXNJbklmcmFtZSA9IHdpbmRvdy5zZWxmICE9PSB3aW5kb3cudG9wO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoaXNJbklmcmFtZSkge1xyXG4gICAgICAgICAgICAvLyBMaWtlbHkgaW4gVGVhbXMsIHRyeSB0byBpbml0aWFsaXplXHJcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxpemVkID0gYXdhaXQgaW5pdGlhbGl6ZVRlYW1zKCk7XHJcbiAgICAgICAgICAgIGlmIChpbml0aWFsaXplZCkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHRlYW1zQ29udGV4dCA9IGF3YWl0IGdldFRlYW1zQ29udGV4dCgpO1xyXG4gICAgICAgICAgICAgIHNldElzVGVhbXModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgc2V0Q29udGV4dCh0ZWFtc0NvbnRleHQpO1xyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIC8vIFNldCB0aGVtZVxyXG4gICAgICAgICAgICAgIGlmICh0ZWFtc0NvbnRleHQ/LnRoZW1lKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaGVtZSh0ZWFtc0NvbnRleHQudGhlbWUpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAvLyBSZWdpc3RlciB0aGVtZSBjaGFuZ2UgaGFuZGxlclxyXG4gICAgICAgICAgICAgIGFwcC5yZWdpc3Rlck9uVGhlbWVDaGFuZ2VIYW5kbGVyKChuZXdUaGVtZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc2V0VGhlbWUobmV3VGhlbWUpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBOb3QgaW4gVGVhbXMsIHNldCBsb2FkaW5nIHRvIGZhbHNlXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdOb3QgcnVubmluZyBpbiBUZWFtcyBjb250ZXh0Jyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdOb3QgcnVubmluZyBpbiBUZWFtcyBjb250ZXh0IG9yIGluaXRpYWxpemF0aW9uIGVycm9yJyk7XHJcbiAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIGluaXQoKTtcclxuICB9LCBbXSk7XHJcblxyXG4gIHJldHVybiB7IGlzVGVhbXMsIGNvbnRleHQsIHRoZW1lLCBsb2FkaW5nIH07XHJcbn07XHJcblxyXG4vKipcclxuICogUmVnaXN0ZXIgdGhlIGNvbmZpZyBoYW5kbGVyIGZvciBjb25maWd1cmFibGUgdGFic1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHJlZ2lzdGVyVGFiQ29uZmlnSGFuZGxlciA9IChjb250ZW50VXJsLCB3ZWJzaXRlVXJsLCBlbnRpdHlJZCwgbmFtZSkgPT4ge1xyXG4gIHBhZ2VzLmNvbmZpZy5yZWdpc3Rlck9uU2F2ZUhhbmRsZXIoKHNhdmVFdmVudCkgPT4ge1xyXG4gICAgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgICAgIGVudGl0eUlkLFxyXG4gICAgICBjb250ZW50VXJsLFxyXG4gICAgICB3ZWJzaXRlVXJsLFxyXG4gICAgICBzdWdnZXN0ZWREaXNwbGF5TmFtZTogbmFtZVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcGFnZXMuY29uZmlnLnNldENvbmZpZyhzZXR0aW5ncyk7XHJcbiAgICBzYXZlRXZlbnQubm90aWZ5U3VjY2VzcygpO1xyXG4gIH0pO1xyXG4gIFxyXG4gIC8vIEVuYWJsZSB0aGUgc2F2ZSBidXR0b25cclxuICBwYWdlcy5jb25maWcuc2V0VmFsaWRpdHlTdGF0ZSh0cnVlKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBPcGVuIGEgVVJMIGluIGEgVGVhbXMgdGFzayBtb2R1bGUgKGRpYWxvZylcclxuICovXHJcbmV4cG9ydCBjb25zdCBvcGVuVGFza01vZHVsZSA9IGFzeW5jICh1cmwsIHRpdGxlLCB3aWR0aCwgaGVpZ2h0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHRhc2tJbmZvID0ge1xyXG4gICAgICB1cmwsXHJcbiAgICAgIHRpdGxlLFxyXG4gICAgICB3aWR0aCxcclxuICAgICAgaGVpZ2h0XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBhd2FpdCBwYWdlcy50YXNrcy5zdGFydFRhc2sodGFza0luZm8pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBvcGVuaW5nIHRhc2sgbW9kdWxlOicsIGVycm9yKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IHRoZW1lIGNsYXNzIG5hbWUgYmFzZWQgb24gVGVhbXMgdGhlbWVcclxuICovXHJcbmV4cG9ydCBjb25zdCBnZXRUaGVtZUNsYXNzTmFtZSA9ICh0aGVtZSkgPT4ge1xyXG4gIHN3aXRjaCAodGhlbWUpIHtcclxuICAgIGNhc2UgJ2RhcmsnOlxyXG4gICAgICByZXR1cm4gJ3RlYW1zLWRhcmstdGhlbWUgZGFyayc7XHJcbiAgICBjYXNlICdjb250cmFzdCc6XHJcbiAgICAgIHJldHVybiAndGVhbXMtY29udHJhc3QtdGhlbWUgZGFyayc7XHJcbiAgICBjYXNlICdkZWZhdWx0JzpcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIHJldHVybiAndGVhbXMtbGlnaHQtdGhlbWUnO1xyXG4gIH1cclxufTsiXSwibmFtZXMiOlsidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJhcHAiLCJwYWdlcyIsImluaXRpYWxpemVUZWFtcyIsImlzSW5JZnJhbWUiLCJ3aW5kb3ciLCJzZWxmIiwidG9wIiwiaW5pdGlhbGl6ZSIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsImdldFRlYW1zQ29udGV4dCIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwidXNlVGVhbXNDb250ZXh0IiwiaXNUZWFtcyIsInNldElzVGVhbXMiLCJzZXRDb250ZXh0IiwidGhlbWUiLCJzZXRUaGVtZSIsImxvYWRpbmciLCJzZXRMb2FkaW5nIiwiaW5pdCIsImluaXRpYWxpemVkIiwidGVhbXNDb250ZXh0IiwicmVnaXN0ZXJPblRoZW1lQ2hhbmdlSGFuZGxlciIsIm5ld1RoZW1lIiwicmVnaXN0ZXJUYWJDb25maWdIYW5kbGVyIiwiY29udGVudFVybCIsIndlYnNpdGVVcmwiLCJlbnRpdHlJZCIsIm5hbWUiLCJjb25maWciLCJyZWdpc3Rlck9uU2F2ZUhhbmRsZXIiLCJzYXZlRXZlbnQiLCJzZXR0aW5ncyIsInN1Z2dlc3RlZERpc3BsYXlOYW1lIiwic2V0Q29uZmlnIiwibm90aWZ5U3VjY2VzcyIsInNldFZhbGlkaXR5U3RhdGUiLCJvcGVuVGFza01vZHVsZSIsInVybCIsInRpdGxlIiwid2lkdGgiLCJoZWlnaHQiLCJ0YXNrSW5mbyIsInRhc2tzIiwic3RhcnRUYXNrIiwiZ2V0VGhlbWVDbGFzc05hbWUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/teamsHelpers.js\n");

/***/ }),

/***/ "./pages/_app.js":
/*!***********************!*\
  !*** ./pages/_app.js ***!
  \***********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _styles_globals_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../styles/globals.css */ \"./styles/globals.css\");\n/* harmony import */ var _styles_globals_css__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_styles_globals_css__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_teamsHelpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../lib/teamsHelpers */ \"./lib/teamsHelpers.js\");\n/* harmony import */ var _lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../lib/teamsAuth */ \"./lib/teamsAuth.js\");\n/* harmony import */ var _lib_api__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../lib/api */ \"./lib/api.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__, _lib_api__WEBPACK_IMPORTED_MODULE_5__]);\n([_lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__, _lib_api__WEBPACK_IMPORTED_MODULE_5__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n\n// Development environment flag\nconst isDevelopment = \"development\" === \"development\";\nfunction MyApp({ Component, pageProps }) {\n    const { isTeams, context, loading: teamsLoading } = (0,_lib_teamsHelpers__WEBPACK_IMPORTED_MODULE_3__.useTeamsContext)();\n    const [user, setUser] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n    const [authLoading, setAuthLoading] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(true);\n    // Initialize authentication\n    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{\n        const initAuth = async ()=>{\n            // Check if we're already authenticated\n            if (_lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__[\"default\"].checkAuth()) {\n                setUser(_lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__[\"default\"].user);\n                (0,_lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__.configureApiAuth)();\n                setAuthLoading(false);\n                return;\n            }\n            // Handle development environment - bypass Teams auth\n            if (isDevelopment && !isTeams) {\n                console.log(\"Development environment detected. Authentication bypass available at /test-auth\");\n            // Optional: Create a development user for testing\n            // Uncomment the following to automatically authenticate in development\n            /*\r\n        const devUser = {\r\n          id: 'dev-user-id',\r\n          username: 'dev-user',\r\n          email: 'dev@example.com',\r\n          department: 'Development'\r\n        };\r\n        setUser(devUser);\r\n        */ }\n            // Only try Teams authentication if we're in Teams context\n            if (isTeams && !teamsLoading && context) {\n                try {\n                    const initialized = await _lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__[\"default\"].initialize();\n                    if (!initialized) {\n                        console.warn(\"Teams SDK initialization failed - continuing without Teams auth\");\n                        setAuthLoading(false);\n                        return;\n                    }\n                    console.log(\"Teams client type:\", context.hostClientType || \"unknown\");\n                    const authenticatedUser = await _lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__[\"default\"].login();\n                    if (authenticatedUser) {\n                        console.log(\"Authentication successful\");\n                        setUser(authenticatedUser);\n                        (0,_lib_teamsAuth__WEBPACK_IMPORTED_MODULE_4__.configureApiAuth)();\n                    } else {\n                        console.error(\"Authentication failed - no user returned\");\n                    }\n                } catch (error) {\n                    console.error(\"Teams authentication failed:\", error);\n                }\n            }\n            setAuthLoading(false);\n        };\n        initAuth();\n    }, [\n        isTeams,\n        teamsLoading,\n        context\n    ]);\n    // Show loading state while Teams is initializing\n    if (teamsLoading || authLoading) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"flex items-center justify-center min-h-screen\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"text-center\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"spinner-border animate-spin inline-block w-8 h-8 border-4 rounded-full text-blue-600\",\n                        role: \"status\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                            className: \"visually-hidden\",\n                            children: \"Loading...\"\n                        }, void 0, false, {\n                            fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                            lineNumber: 80,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                        lineNumber: 79,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"mt-2\",\n                        children: \"Loading...\"\n                    }, void 0, false, {\n                        fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                        lineNumber: 82,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                lineNumber: 78,\n                columnNumber: 9\n            }, this)\n        }, void 0, false, {\n            fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n            lineNumber: 77,\n            columnNumber: 7\n        }, this);\n    }\n    // Show auth warning in development mode\n    if (isDevelopment && !user) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"bg-yellow-100 border-l-4 border-yellow-500 p-4 m-4\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-yellow-700\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"strong\", {\n                                children: \"Development Mode:\"\n                            }, void 0, false, {\n                                fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                                lineNumber: 94,\n                                columnNumber: 13\n                            }, this),\n                            \" You're not authenticated. Visit \",\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"a\", {\n                                href: \"/test-auth\",\n                                className: \"underline\",\n                                children: \"the test auth page\"\n                            }, void 0, false, {\n                                fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                                lineNumber: 94,\n                                columnNumber: 80\n                            }, this),\n                            \" to authenticate, or continue as an unauthenticated user.\"\n                        ]\n                    }, void 0, true, {\n                        fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                        lineNumber: 93,\n                        columnNumber: 11\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                    lineNumber: 92,\n                    columnNumber: 9\n                }, this),\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Component, {\n                    ...pageProps,\n                    user: user,\n                    isTeams: isTeams,\n                    teamsContext: context\n                }, void 0, false, {\n                    fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n                    lineNumber: 97,\n                    columnNumber: 9\n                }, this)\n            ]\n        }, void 0, true);\n    }\n    // Pass authentication details to all pages\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Component, {\n        ...pageProps,\n        user: user,\n        isTeams: isTeams,\n        teamsContext: context\n    }, void 0, false, {\n        fileName: \"D:\\\\Codes\\\\Deployed OKR\\\\fe_okr-fi2\\\\pages\\\\_app.js\",\n        lineNumber: 103,\n        columnNumber: 10\n    }, this);\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MyApp);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWdlcy9fYXBwLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStCO0FBQ2E7QUFDVTtBQUNiO0FBQ1c7QUFDdkI7QUFFN0IsK0JBQStCO0FBQy9CLE1BQU1NLGdCQUFnQkMsa0JBQXlCO0FBRS9DLFNBQVNDLE1BQU0sRUFBRUMsU0FBUyxFQUFFQyxTQUFTLEVBQUU7SUFDckMsTUFBTSxFQUFFQyxPQUFPLEVBQUVDLE9BQU8sRUFBRUMsU0FBU0MsWUFBWSxFQUFFLEdBQUdaLGtFQUFlQTtJQUNuRSxNQUFNLENBQUNhLE1BQU1DLFFBQVEsR0FBR2YsK0NBQVFBLENBQUM7SUFDakMsTUFBTSxDQUFDZ0IsYUFBYUMsZUFBZSxHQUFHakIsK0NBQVFBLENBQUM7SUFFL0MsNEJBQTRCO0lBQzVCRCxnREFBU0EsQ0FBQztRQUNSLE1BQU1tQixXQUFXO1lBQ2YsdUNBQXVDO1lBQ3ZDLElBQUloQixnRUFBbUIsSUFBSTtnQkFDekJhLFFBQVFiLDJEQUFjO2dCQUN0QkMsZ0VBQWdCQTtnQkFDaEJjLGVBQWU7Z0JBQ2Y7WUFDRjtZQUVBLHFEQUFxRDtZQUNyRCxJQUFJWixpQkFBaUIsQ0FBQ0ssU0FBUztnQkFDN0JVLFFBQVFDLEdBQUcsQ0FBQztZQUVaLGtEQUFrRDtZQUNsRCx1RUFBdUU7WUFDdkU7Ozs7Ozs7O1FBUUEsR0FDRjtZQUNFLDBEQUEwRDtZQUM1RCxJQUFJWCxXQUFXLENBQUNHLGdCQUFnQkYsU0FBUztnQkFDdkMsSUFBSTtvQkFDRixNQUFNVyxjQUFjLE1BQU1wQixpRUFBb0I7b0JBQzlDLElBQUksQ0FBQ29CLGFBQWE7d0JBQ2hCRixRQUFRSSxJQUFJLENBQUM7d0JBQ2JQLGVBQWU7d0JBQ2Y7b0JBQ0Y7b0JBRUFHLFFBQVFDLEdBQUcsQ0FBQyxzQkFBc0JWLFFBQVFjLGNBQWMsSUFBSTtvQkFDNUQsTUFBTUMsb0JBQW9CLE1BQU14Qiw0REFBZTtvQkFFL0MsSUFBSXdCLG1CQUFtQjt3QkFDckJOLFFBQVFDLEdBQUcsQ0FBQzt3QkFDWk4sUUFBUVc7d0JBQ1J2QixnRUFBZ0JBO29CQUNsQixPQUFPO3dCQUNMaUIsUUFBUVEsS0FBSyxDQUFDO29CQUNoQjtnQkFDRixFQUFFLE9BQU9BLE9BQU87b0JBQ2RSLFFBQVFRLEtBQUssQ0FBQyxnQ0FBZ0NBO2dCQUNoRDtZQUNGO1lBRUFYLGVBQWU7UUFDakI7UUFFQUM7SUFDRixHQUFHO1FBQUNSO1FBQVNHO1FBQWNGO0tBQVE7SUFFbkMsaURBQWlEO0lBQ2pELElBQUlFLGdCQUFnQkcsYUFBYTtRQUMvQixxQkFDRSw4REFBQ2E7WUFBSUMsV0FBVTtzQkFDYiw0RUFBQ0Q7Z0JBQUlDLFdBQVU7O2tDQUNiLDhEQUFDRDt3QkFBSUMsV0FBVTt3QkFBdUZDLE1BQUs7a0NBQ3pHLDRFQUFDQzs0QkFBS0YsV0FBVTtzQ0FBa0I7Ozs7Ozs7Ozs7O2tDQUVwQyw4REFBQ0c7d0JBQUVILFdBQVU7a0NBQU87Ozs7Ozs7Ozs7Ozs7Ozs7O0lBSTVCO0lBRUEsd0NBQXdDO0lBQ3hDLElBQUl6QixpQkFBaUIsQ0FBQ1MsTUFBTTtRQUMxQixxQkFDRTs7OEJBQ0UsOERBQUNlO29CQUFJQyxXQUFVOzhCQUNiLDRFQUFDRzt3QkFBRUgsV0FBVTs7MENBQ1gsOERBQUNJOzBDQUFPOzs7Ozs7NEJBQTBCOzBDQUFpQyw4REFBQ0M7Z0NBQUVDLE1BQUs7Z0NBQWFOLFdBQVU7MENBQVk7Ozs7Ozs0QkFBc0I7Ozs7Ozs7Ozs7Ozs4QkFHeEksOERBQUN0QjtvQkFBVyxHQUFHQyxTQUFTO29CQUFFSyxNQUFNQTtvQkFBTUosU0FBU0E7b0JBQVMyQixjQUFjMUI7Ozs7Ozs7O0lBRzVFO0lBRUEsMkNBQTJDO0lBQzNDLHFCQUFPLDhEQUFDSDtRQUFXLEdBQUdDLFNBQVM7UUFBRUssTUFBTUE7UUFBTUosU0FBU0E7UUFBUzJCLGNBQWMxQjs7Ozs7O0FBQy9FO0FBRUEsaUVBQWVKLEtBQUtBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9va3ItdHJlZS1mcm9udGVuZC8uL3BhZ2VzL19hcHAuanM/ZTBhZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJy4uL3N0eWxlcy9nbG9iYWxzLmNzcyc7XHJcbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHVzZVRlYW1zQ29udGV4dCB9IGZyb20gJy4uL2xpYi90ZWFtc0hlbHBlcnMnO1xyXG5pbXBvcnQgdGVhbXNBdXRoIGZyb20gJy4uL2xpYi90ZWFtc0F1dGgnO1xyXG5pbXBvcnQgeyBjb25maWd1cmVBcGlBdXRoIH0gZnJvbSAnLi4vbGliL3RlYW1zQXV0aCc7XHJcbmltcG9ydCBhcGkgZnJvbSAnLi4vbGliL2FwaSc7XHJcblxyXG4vLyBEZXZlbG9wbWVudCBlbnZpcm9ubWVudCBmbGFnXHJcbmNvbnN0IGlzRGV2ZWxvcG1lbnQgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JztcclxuXHJcbmZ1bmN0aW9uIE15QXBwKHsgQ29tcG9uZW50LCBwYWdlUHJvcHMgfSkge1xyXG4gIGNvbnN0IHsgaXNUZWFtcywgY29udGV4dCwgbG9hZGluZzogdGVhbXNMb2FkaW5nIH0gPSB1c2VUZWFtc0NvbnRleHQoKTtcclxuICBjb25zdCBbdXNlciwgc2V0VXNlcl0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbYXV0aExvYWRpbmcsIHNldEF1dGhMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG4gIFxyXG4gIC8vIEluaXRpYWxpemUgYXV0aGVudGljYXRpb25cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgY29uc3QgaW5pdEF1dGggPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIENoZWNrIGlmIHdlJ3JlIGFscmVhZHkgYXV0aGVudGljYXRlZFxyXG4gICAgICBpZiAodGVhbXNBdXRoLmNoZWNrQXV0aCgpKSB7XHJcbiAgICAgICAgc2V0VXNlcih0ZWFtc0F1dGgudXNlcik7XHJcbiAgICAgICAgY29uZmlndXJlQXBpQXV0aCgpO1xyXG4gICAgICAgIHNldEF1dGhMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEhhbmRsZSBkZXZlbG9wbWVudCBlbnZpcm9ubWVudCAtIGJ5cGFzcyBUZWFtcyBhdXRoXHJcbiAgICAgIGlmIChpc0RldmVsb3BtZW50ICYmICFpc1RlYW1zKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0RldmVsb3BtZW50IGVudmlyb25tZW50IGRldGVjdGVkLiBBdXRoZW50aWNhdGlvbiBieXBhc3MgYXZhaWxhYmxlIGF0IC90ZXN0LWF1dGgnKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBPcHRpb25hbDogQ3JlYXRlIGEgZGV2ZWxvcG1lbnQgdXNlciBmb3IgdGVzdGluZ1xyXG4gICAgICAgIC8vIFVuY29tbWVudCB0aGUgZm9sbG93aW5nIHRvIGF1dG9tYXRpY2FsbHkgYXV0aGVudGljYXRlIGluIGRldmVsb3BtZW50XHJcbiAgICAgICAgLypcclxuICAgICAgICBjb25zdCBkZXZVc2VyID0ge1xyXG4gICAgICAgICAgaWQ6ICdkZXYtdXNlci1pZCcsXHJcbiAgICAgICAgICB1c2VybmFtZTogJ2Rldi11c2VyJyxcclxuICAgICAgICAgIGVtYWlsOiAnZGV2QGV4YW1wbGUuY29tJyxcclxuICAgICAgICAgIGRlcGFydG1lbnQ6ICdEZXZlbG9wbWVudCdcclxuICAgICAgICB9O1xyXG4gICAgICAgIHNldFVzZXIoZGV2VXNlcik7XHJcbiAgICAgICAgKi9cclxuICAgICAgfVxyXG4gICAgICAgIC8vIE9ubHkgdHJ5IFRlYW1zIGF1dGhlbnRpY2F0aW9uIGlmIHdlJ3JlIGluIFRlYW1zIGNvbnRleHRcclxuICAgICAgaWYgKGlzVGVhbXMgJiYgIXRlYW1zTG9hZGluZyAmJiBjb250ZXh0KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IGluaXRpYWxpemVkID0gYXdhaXQgdGVhbXNBdXRoLmluaXRpYWxpemUoKTtcclxuICAgICAgICAgIGlmICghaW5pdGlhbGl6ZWQpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdUZWFtcyBTREsgaW5pdGlhbGl6YXRpb24gZmFpbGVkIC0gY29udGludWluZyB3aXRob3V0IFRlYW1zIGF1dGgnKTtcclxuICAgICAgICAgICAgc2V0QXV0aExvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdUZWFtcyBjbGllbnQgdHlwZTonLCBjb250ZXh0Lmhvc3RDbGllbnRUeXBlIHx8ICd1bmtub3duJyk7XHJcbiAgICAgICAgICBjb25zdCBhdXRoZW50aWNhdGVkVXNlciA9IGF3YWl0IHRlYW1zQXV0aC5sb2dpbigpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoYXV0aGVudGljYXRlZFVzZXIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0F1dGhlbnRpY2F0aW9uIHN1Y2Nlc3NmdWwnKTtcclxuICAgICAgICAgICAgc2V0VXNlcihhdXRoZW50aWNhdGVkVXNlcik7XHJcbiAgICAgICAgICAgIGNvbmZpZ3VyZUFwaUF1dGgoKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZCAtIG5vIHVzZXIgcmV0dXJuZWQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignVGVhbXMgYXV0aGVudGljYXRpb24gZmFpbGVkOicsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHNldEF1dGhMb2FkaW5nKGZhbHNlKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIGluaXRBdXRoKCk7XHJcbiAgfSwgW2lzVGVhbXMsIHRlYW1zTG9hZGluZywgY29udGV4dF0pO1xyXG4gIFxyXG4gIC8vIFNob3cgbG9hZGluZyBzdGF0ZSB3aGlsZSBUZWFtcyBpcyBpbml0aWFsaXppbmdcclxuICBpZiAodGVhbXNMb2FkaW5nIHx8IGF1dGhMb2FkaW5nKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIG1pbi1oLXNjcmVlblwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Bpbm5lci1ib3JkZXIgYW5pbWF0ZS1zcGluIGlubGluZS1ibG9jayB3LTggaC04IGJvcmRlci00IHJvdW5kZWQtZnVsbCB0ZXh0LWJsdWUtNjAwXCIgcm9sZT1cInN0YXR1c1wiPlxyXG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ2aXN1YWxseS1oaWRkZW5cIj5Mb2FkaW5nLi4uPC9zcGFuPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8cCBjbGFzc05hbWU9XCJtdC0yXCI+TG9hZGluZy4uLjwvcD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICApO1xyXG4gIH1cclxuICBcclxuICAvLyBTaG93IGF1dGggd2FybmluZyBpbiBkZXZlbG9wbWVudCBtb2RlXHJcbiAgaWYgKGlzRGV2ZWxvcG1lbnQgJiYgIXVzZXIpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDw+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy15ZWxsb3ctMTAwIGJvcmRlci1sLTQgYm9yZGVyLXllbGxvdy01MDAgcC00IG0tNFwiPlxyXG4gICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC15ZWxsb3ctNzAwXCI+XHJcbiAgICAgICAgICAgIDxzdHJvbmc+RGV2ZWxvcG1lbnQgTW9kZTo8L3N0cm9uZz4gWW91J3JlIG5vdCBhdXRoZW50aWNhdGVkLiBWaXNpdCA8YSBocmVmPVwiL3Rlc3QtYXV0aFwiIGNsYXNzTmFtZT1cInVuZGVybGluZVwiPnRoZSB0ZXN0IGF1dGggcGFnZTwvYT4gdG8gYXV0aGVudGljYXRlLCBvciBjb250aW51ZSBhcyBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cclxuICAgICAgICAgIDwvcD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8Q29tcG9uZW50IHsuLi5wYWdlUHJvcHN9IHVzZXI9e3VzZXJ9IGlzVGVhbXM9e2lzVGVhbXN9IHRlYW1zQ29udGV4dD17Y29udGV4dH0gLz5cclxuICAgICAgPC8+XHJcbiAgICApO1xyXG4gIH1cclxuICBcclxuICAvLyBQYXNzIGF1dGhlbnRpY2F0aW9uIGRldGFpbHMgdG8gYWxsIHBhZ2VzXHJcbiAgcmV0dXJuIDxDb21wb25lbnQgey4uLnBhZ2VQcm9wc30gdXNlcj17dXNlcn0gaXNUZWFtcz17aXNUZWFtc30gdGVhbXNDb250ZXh0PXtjb250ZXh0fSAvPjtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgTXlBcHA7Il0sIm5hbWVzIjpbInVzZUVmZmVjdCIsInVzZVN0YXRlIiwidXNlVGVhbXNDb250ZXh0IiwidGVhbXNBdXRoIiwiY29uZmlndXJlQXBpQXV0aCIsImFwaSIsImlzRGV2ZWxvcG1lbnQiLCJwcm9jZXNzIiwiTXlBcHAiLCJDb21wb25lbnQiLCJwYWdlUHJvcHMiLCJpc1RlYW1zIiwiY29udGV4dCIsImxvYWRpbmciLCJ0ZWFtc0xvYWRpbmciLCJ1c2VyIiwic2V0VXNlciIsImF1dGhMb2FkaW5nIiwic2V0QXV0aExvYWRpbmciLCJpbml0QXV0aCIsImNoZWNrQXV0aCIsImNvbnNvbGUiLCJsb2ciLCJpbml0aWFsaXplZCIsImluaXRpYWxpemUiLCJ3YXJuIiwiaG9zdENsaWVudFR5cGUiLCJhdXRoZW50aWNhdGVkVXNlciIsImxvZ2luIiwiZXJyb3IiLCJkaXYiLCJjbGFzc05hbWUiLCJyb2xlIiwic3BhbiIsInAiLCJzdHJvbmciLCJhIiwiaHJlZiIsInRlYW1zQ29udGV4dCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./pages/_app.js\n");

/***/ }),

/***/ "./styles/globals.css":
/*!****************************!*\
  !*** ./styles/globals.css ***!
  \****************************/
/***/ (() => {



/***/ }),

/***/ "@microsoft/teams-js":
/*!**************************************!*\
  !*** external "@microsoft/teams-js" ***!
  \**************************************/
/***/ ((module) => {

"use strict";
module.exports = require("@microsoft/teams-js");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("react");

/***/ }),

/***/ "react/jsx-dev-runtime":
/*!****************************************!*\
  !*** external "react/jsx-dev-runtime" ***!
  \****************************************/
/***/ ((module) => {

"use strict";
module.exports = require("react/jsx-dev-runtime");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = import("axios");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./pages/_app.js"));
module.exports = __webpack_exports__;

})();